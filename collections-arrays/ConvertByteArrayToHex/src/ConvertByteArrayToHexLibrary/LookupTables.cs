namespace ConvertByteArrayHexLibrary;

public static class LookupTables
{
    internal static readonly uint[] HexLookupUpperLittleEndian =
    {
        3145776, 3211312, 3276848, 3342384, 3407920, 3473456, 3538992, 3604528, 3670064, 3735600,
        4259888, 4325424, 4390960, 4456496, 4522032, 4587568, 3145777, 3211313, 3276849, 3342385,
        3407921, 3473457, 3538993, 3604529, 3670065, 3735601, 4259889, 4325425, 4390961, 4456497,
        4522033, 4587569, 3145778, 3211314, 3276850, 3342386, 3407922, 3473458, 3538994, 3604530,
        3670066, 3735602, 4259890, 4325426, 4390962, 4456498, 4522034, 4587570, 3145779, 3211315,
        3276851, 3342387, 3407923, 3473459, 3538995, 3604531, 3670067, 3735603, 4259891, 4325427,
        4390963, 4456499, 4522035, 4587571, 3145780, 3211316, 3276852, 3342388, 3407924, 3473460,
        3538996, 3604532, 3670068, 3735604, 4259892, 4325428, 4390964, 4456500, 4522036, 4587572,
        3145781, 3211317, 3276853, 3342389, 3407925, 3473461, 3538997, 3604533, 3670069, 3735605,
        4259893, 4325429, 4390965, 4456501, 4522037, 4587573, 3145782, 3211318, 3276854, 3342390,
        3407926, 3473462, 3538998, 3604534, 3670070, 3735606, 4259894, 4325430, 4390966, 4456502,
        4522038, 4587574, 3145783, 3211319, 3276855, 3342391, 3407927, 3473463, 3538999, 3604535,
        3670071, 3735607, 4259895, 4325431, 4390967, 4456503, 4522039, 4587575, 3145784, 3211320,
        3276856, 3342392, 3407928, 3473464, 3539000, 3604536, 3670072, 3735608, 4259896, 4325432,
        4390968, 4456504, 4522040, 4587576, 3145785, 3211321, 3276857, 3342393, 3407929, 3473465,
        3539001, 3604537, 3670073, 3735609, 4259897, 4325433, 4390969, 4456505, 4522041, 4587577,
        3145793, 3211329, 3276865, 3342401, 3407937, 3473473, 3539009, 3604545, 3670081, 3735617,
        4259905, 4325441, 4390977, 4456513, 4522049, 4587585, 3145794, 3211330, 3276866, 3342402,
        3407938, 3473474, 3539010, 3604546, 3670082, 3735618, 4259906, 4325442, 4390978, 4456514,
        4522050, 4587586, 3145795, 3211331, 3276867, 3342403, 3407939, 3473475, 3539011, 3604547,
        3670083, 3735619, 4259907, 4325443, 4390979, 4456515, 4522051, 4587587, 3145796, 3211332,
        3276868, 3342404, 3407940, 3473476, 3539012, 3604548, 3670084, 3735620, 4259908, 4325444,
        4390980, 4456516, 4522052, 4587588, 3145797, 3211333, 3276869, 3342405, 3407941, 3473477,
        3539013, 3604549, 3670085, 3735621, 4259909, 4325445, 4390981, 4456517, 4522053, 4587589,
        3145798, 3211334, 3276870, 3342406, 3407942, 3473478, 3539014, 3604550, 3670086, 3735622,
        4259910, 4325446, 4390982, 4456518, 4522054, 4587590
    };

    internal static readonly uint[] HexLookupLowerLittleEndian =
    {
        3145776, 3211312, 3276848, 3342384, 3407920, 3473456, 3538992, 3604528, 3670064, 3735600,
        6357040, 6422576, 6488112, 6553648, 6619184, 6684720, 3145777, 3211313, 3276849, 3342385,
        3407921, 3473457, 3538993, 3604529, 3670065, 3735601, 6357041, 6422577, 6488113, 6553649,
        6619185, 6684721, 3145778, 3211314, 3276850, 3342386, 3407922, 3473458, 3538994, 3604530,
        3670066, 3735602, 6357042, 6422578, 6488114, 6553650, 6619186, 6684722, 3145779, 3211315,
        3276851, 3342387, 3407923, 3473459, 3538995, 3604531, 3670067, 3735603, 6357043, 6422579,
        6488115, 6553651, 6619187, 6684723, 3145780, 3211316, 3276852, 3342388, 3407924, 3473460,
        3538996, 3604532, 3670068, 3735604, 6357044, 6422580, 6488116, 6553652, 6619188, 6684724,
        3145781, 3211317, 3276853, 3342389, 3407925, 3473461, 3538997, 3604533, 3670069, 3735605,
        6357045, 6422581, 6488117, 6553653, 6619189, 6684725, 3145782, 3211318, 3276854, 3342390,
        3407926, 3473462, 3538998, 3604534, 3670070, 3735606, 6357046, 6422582, 6488118, 6553654,
        6619190, 6684726, 3145783, 3211319, 3276855, 3342391, 3407927, 3473463, 3538999, 3604535,
        3670071, 3735607, 6357047, 6422583, 6488119, 6553655, 6619191, 6684727, 3145784, 3211320,
        3276856, 3342392, 3407928, 3473464, 3539000, 3604536, 3670072, 3735608, 6357048, 6422584,
        6488120, 6553656, 6619192, 6684728, 3145785, 3211321, 3276857, 3342393, 3407929, 3473465,
        3539001, 3604537, 3670073, 3735609, 6357049, 6422585, 6488121, 6553657, 6619193, 6684729,
        3145825, 3211361, 3276897, 3342433, 3407969, 3473505, 3539041, 3604577, 3670113, 3735649,
        6357089, 6422625, 6488161, 6553697, 6619233, 6684769, 3145826, 3211362, 3276898, 3342434,
        3407970, 3473506, 3539042, 3604578, 3670114, 3735650, 6357090, 6422626, 6488162, 6553698,
        6619234, 6684770, 3145827, 3211363, 3276899, 3342435, 3407971, 3473507, 3539043, 3604579,
        3670115, 3735651, 6357091, 6422627, 6488163, 6553699, 6619235, 6684771, 3145828, 3211364,
        3276900, 3342436, 3407972, 3473508, 3539044, 3604580, 3670116, 3735652, 6357092, 6422628,
        6488164, 6553700, 6619236, 6684772, 3145829, 3211365, 3276901, 3342437, 3407973, 3473509,
        3539045, 3604581, 3670117, 3735653, 6357093, 6422629, 6488165, 6553701, 6619237, 6684773,
        3145830, 3211366, 3276902, 3342438, 3407974, 3473510, 3539046, 3604582, 3670118, 3735654,
        6357094, 6422630, 6488166, 6553702, 6619238, 6684774
    };

    internal static readonly uint[] HexLookupUpperBigEndian =
    {
        3145776, 3145777, 3145778, 3145779, 3145780, 3145781, 3145782, 3145783, 3145784, 3145785,
        3145793, 3145794, 3145795, 3145796, 3145797, 3145798, 3211312, 3211313, 3211314, 3211315,
        3211316, 3211317, 3211318, 3211319, 3211320, 3211321, 3211329, 3211330, 3211331, 3211332,
        3211333, 3211334, 3276848, 3276849, 3276850, 3276851, 3276852, 3276853, 3276854, 3276855,
        3276856, 3276857, 3276865, 3276866, 3276867, 3276868, 3276869, 3276870, 3342384, 3342385,
        3342386, 3342387, 3342388, 3342389, 3342390, 3342391, 3342392, 3342393, 3342401, 3342402,
        3342403, 3342404, 3342405, 3342406, 3407920, 3407921, 3407922, 3407923, 3407924, 3407925,
        3407926, 3407927, 3407928, 3407929, 3407937, 3407938, 3407939, 3407940, 3407941, 3407942,
        3473456, 3473457, 3473458, 3473459, 3473460, 3473461, 3473462, 3473463, 3473464, 3473465,
        3473473, 3473474, 3473475, 3473476, 3473477, 3473478, 3538992, 3538993, 3538994, 3538995,
        3538996, 3538997, 3538998, 3538999, 3539000, 3539001, 3539009, 3539010, 3539011, 3539012,
        3539013, 3539014, 3604528, 3604529, 3604530, 3604531, 3604532, 3604533, 3604534, 3604535,
        3604536, 3604537, 3604545, 3604546, 3604547, 3604548, 3604549, 3604550, 3670064, 3670065,
        3670066, 3670067, 3670068, 3670069, 3670070, 3670071, 3670072, 3670073, 3670081, 3670082,
        3670083, 3670084, 3670085, 3670086, 3735600, 3735601, 3735602, 3735603, 3735604, 3735605,
        3735606, 3735607, 3735608, 3735609, 3735617, 3735618, 3735619, 3735620, 3735621, 3735622,
        4259888, 4259889, 4259890, 4259891, 4259892, 4259893, 4259894, 4259895, 4259896, 4259897,
        4259905, 4259906, 4259907, 4259908, 4259909, 4259910, 4325424, 4325425, 4325426, 4325427,
        4325428, 4325429, 4325430, 4325431, 4325432, 4325433, 4325441, 4325442, 4325443, 4325444,
        4325445, 4325446, 4390960, 4390961, 4390962, 4390963, 4390964, 4390965, 4390966, 4390967,
        4390968, 4390969, 4390977, 4390978, 4390979, 4390980, 4390981, 4390982, 4456496, 4456497,
        4456498, 4456499, 4456500, 4456501, 4456502, 4456503, 4456504, 4456505, 4456513, 4456514,
        4456515, 4456516, 4456517, 4456518, 4522032, 4522033, 4522034, 4522035, 4522036, 4522037,
        4522038, 4522039, 4522040, 4522041, 4522049, 4522050, 4522051, 4522052, 4522053, 4522054,
        4587568, 4587569, 4587570, 4587571, 4587572, 4587573, 4587574, 4587575, 4587576, 4587577,
        4587585, 4587586, 4587587, 4587588, 4587589, 4587590
    };

    internal static readonly uint[] HexLookupLowerBigEndian =
    {
        3145776, 3145777, 3145778, 3145779, 3145780, 3145781, 3145782, 3145783, 3145784, 3145785,
        3145825, 3145826, 3145827, 3145828, 3145829, 3145830, 3211312, 3211313, 3211314, 3211315,
        3211316, 3211317, 3211318, 3211319, 3211320, 3211321, 3211361, 3211362, 3211363, 3211364,
        3211365, 3211366, 3276848, 3276849, 3276850, 3276851, 3276852, 3276853, 3276854, 3276855,
        3276856, 3276857, 3276897, 3276898, 3276899, 3276900, 3276901, 3276902, 3342384, 3342385,
        3342386, 3342387, 3342388, 3342389, 3342390, 3342391, 3342392, 3342393, 3342433, 3342434,
        3342435, 3342436, 3342437, 3342438, 3407920, 3407921, 3407922, 3407923, 3407924, 3407925,
        3407926, 3407927, 3407928, 3407929, 3407969, 3407970, 3407971, 3407972, 3407973, 3407974,
        3473456, 3473457, 3473458, 3473459, 3473460, 3473461, 3473462, 3473463, 3473464, 3473465,
        3473505, 3473506, 3473507, 3473508, 3473509, 3473510, 3538992, 3538993, 3538994, 3538995,
        3538996, 3538997, 3538998, 3538999, 3539000, 3539001, 3539041, 3539042, 3539043, 3539044,
        3539045, 3539046, 3604528, 3604529, 3604530, 3604531, 3604532, 3604533, 3604534, 3604535,
        3604536, 3604537, 3604577, 3604578, 3604579, 3604580, 3604581, 3604582, 3670064, 3670065,
        3670066, 3670067, 3670068, 3670069, 3670070, 3670071, 3670072, 3670073, 3670113, 3670114,
        3670115, 3670116, 3670117, 3670118, 3735600, 3735601, 3735602, 3735603, 3735604, 3735605,
        3735606, 3735607, 3735608, 3735609, 3735649, 3735650, 3735651, 3735652, 3735653, 3735654,
        6357040, 6357041, 6357042, 6357043, 6357044, 6357045, 6357046, 6357047, 6357048, 6357049,
        6357089, 6357090, 6357091, 6357092, 6357093, 6357094, 6422576, 6422577, 6422578, 6422579,
        6422580, 6422581, 6422582, 6422583, 6422584, 6422585, 6422625, 6422626, 6422627, 6422628,
        6422629, 6422630, 6488112, 6488113, 6488114, 6488115, 6488116, 6488117, 6488118, 6488119,
        6488120, 6488121, 6488161, 6488162, 6488163, 6488164, 6488165, 6488166, 6553648, 6553649,
        6553650, 6553651, 6553652, 6553653, 6553654, 6553655, 6553656, 6553657, 6553697, 6553698,
        6553699, 6553700, 6553701, 6553702, 6619184, 6619185, 6619186, 6619187, 6619188, 6619189,
        6619190, 6619191, 6619192, 6619193, 6619233, 6619234, 6619235, 6619236, 6619237, 6619238,
        6684720, 6684721, 6684722, 6684723, 6684724, 6684725, 6684726, 6684727, 6684728, 6684729,
        6684769, 6684770, 6684771, 6684772, 6684773, 6684774
    };

    private static ReadOnlySpan<byte> HexAlphabetSpanUpper => "0123456789ABCDEF"u8;
    private static ReadOnlySpan<byte> HexAlphabetSpanLower => "0123456789abcdef"u8;

    public static uint[] GetLookupTable(bool toLower) =>
        toLower
            ? BitConverter.IsLittleEndian ? HexLookupLowerLittleEndian : HexLookupLowerBigEndian
            : BitConverter.IsLittleEndian
                ? HexLookupUpperLittleEndian
                : HexLookupUpperBigEndian;

    internal static ReadOnlySpan<byte> GetAlphabetSpan(bool toLower) =>
        toLower ? HexAlphabetSpanLower : HexAlphabetSpanUpper;

    public static uint[] CreateLookup(bool lowercase, bool littleEndian)
    {
        var format = lowercase ? "x2" : "X2";

        Span<char> s = stackalloc char[2];
        var result = GC.AllocateUninitializedArray<uint>(256);
        for (var i = 0; i < 256; i++)
        {
            i.TryFormat(s, out _, format);
            if (littleEndian)
                result[i] = s[0] + ((uint) s[1] << 16);
            else
                result[i] = s[1] + ((uint) s[0] << 16);
        }

        return result;
    }
}